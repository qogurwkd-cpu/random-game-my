<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>오늘의 행운아 뽑기</title>
<style>
  body { 
    font-family: 'Apple SD Gothic Neo', sans-serif; 
    text-align: center; 
    background-color: #f4f4f9; 
    padding: 20px; 
    margin: 0; 
  }
  h2 { color: #333; margin-bottom: 20px; }
  
  .controls { 
    background: white; padding: 15px; border-radius: 12px; 
    box-shadow: 0 4px 10px rgba(0,0,0,0.05); margin-bottom: 20px; font-size: 16px;
  }
  input { 
    width: 50px; padding: 8px; font-size: 16px; text-align: center; 
    border: 1px solid #ccc; border-radius: 6px; margin: 0 5px;
  }
  button { 
    width: 100%; padding: 12px; font-size: 18px; font-weight: bold; 
    color: white; background-color: #28a745; border: none; 
    border-radius: 10px; cursor: pointer; margin-top: 15px;
    box-shadow: 0 4px 6px rgba(40,167,69,0.3);
  }
  button:active { background-color: #218838; transform: scale(0.98); }
  
  .lots-container { 
    display: flex; flex-wrap: wrap; justify-content: center; gap: 12px; margin-top: 20px; 
  }
  
  .lot { 
    width: 70px; height: 100px; background-color: #007bff; 
    display: flex; align-items: center; justify-content: center; 
    font-size: 20px; font-weight: bold; border-radius: 8px; 
    box-shadow: 0 4px 8px rgba(0,0,0,0.2); 
    transition: transform 0.4s, background-color 0.4s; 
    user-select: none; color: white;
  }
  .lot .text { display: none; }
  .lot .question { display: block; font-size: 30px; }

  .lot.opened { transform: rotateY(180deg); }
  .lot.opened .text { display: block; transform: rotateY(180deg); }
  .lot.opened .question { display: none; }

  .lot.opened.win { background-color: #dc3545; }
  .lot.opened.lose { background-color: #6c757d; }
  .lot.opened.exemption { background-color: #ffc107; color: #333; } /* 함정카드는 눈부신 황금색! */

  /* 팝업 스타일 */
  .popup-container {
    display: none; 
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.8); 
    z-index: 1000; justify-content: center; align-items: center; flex-direction: column;
  }
  .popup-container img {
    max-width: 85%; max-height: 85%; border-radius: 15px;
    box-shadow: 0 10px 30px rgba(255,255,255,0.3);
    animation: popUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
  }
  .popup-text {
    color: white; font-size: 28px; font-weight: bold; margin-top: 20px; /* 글씨 크기 살짝 키움 */
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    animation: fadeIn 0.8s ease-in;
  }
  @keyframes popUp { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
</style>
</head>
<body>

  <h2>오늘의 행운아는 누구?</h2>
  
  <div class="controls">
    <label>카드 개수: <input type="number" id="total" value="10" min="2" max="30"></label> 개 <br><br>
    <label>꽝 개수: <input type="number" id="winCount" value="1" min="1" max="29"></label> 개 <br>
    <button onclick="startGame()">새로 섞기!</button>
  </div>

  <div class="lots-container" id="lotsContainer"></div>

  <div id="imagePopup" class="popup-container">
    <img src="trappedcard.png" alt="함정카드 이미지">
    <div class="popup-text">함정카드 발동!</div>
  </div>

  <script>
    let results = [];
    const popup = document.getElementById('imagePopup'); 

    function startGame() {
      const total = parseInt(document.getElementById('total').value);
      const winCount = parseInt(document.getElementById('winCount').value);
      const container = document.getElementById('lotsContainer');
      
      if (winCount >= total) {
        alert("꽝 개수가 카드 개수보다 적어야 해!");
        return;
      }

      results = Array(total).fill('통과');
      for (let i = 0; i < winCount; i++) {
        results[i] = '꽝!';
      }

      // 10개 이상일 때 50% 확률로 '함정' 카드 추가
      if (total >= 10 && Math.random() < 0.5) {
        results[winCount] = '함정'; // 텍스트 변경: 면제! -> 함정
      }

      for (let i = results.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [results[i], results[j]] = [results[j], results[i]];
      }

      container.innerHTML = '';
      for (let i = 0; i < total; i++) {
        const lot = document.createElement('div');
        lot.className = 'lot';
        
        lot.innerHTML = `
          <span class="question">?</span>
          <span class="text">${results[i]}</span>
        `;
        
        lot.onclick = function() {
          if (this.classList.contains('opened')) return; 
          
          this.classList.add('opened');
          
          if (results[i] === '꽝!') {
            this.classList.add('win');
          } else if (results[i] === '함정') { // 텍스트 변경: 면제! -> 함정
            this.classList.add('exemption');
            popup.style.display = 'flex'; 
          } else {
            this.classList.add('lose');
          }
        };
        
        container.appendChild(lot);
      }
    }

    popup.onclick = function() {
      this.style.display = 'none';
    };

    startGame();
  </script>
</body>
</html>